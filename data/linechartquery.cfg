SELECT game_date, winrate_each_day, games_played, games_won, aggregate_winrate FROM ( SELECT DATE(game_timestamp) AS game_date, CAST(SUM(CASE WHEN game_winner = 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*) AS winrate_each_day, COUNT(*) AS games_played, SUM(CASE WHEN game_winner = 1 THEN 1 ELSE 0 END) AS games_won, CAST(SUM(SUM(CASE WHEN game_winner = 1 THEN 1 ELSE 0 END)) OVER (ORDER BY DATE(game_timestamp)) AS FLOAT) / SUM(COUNT(*)) OVER (ORDER BY DATE(game_timestamp)) AS aggregate_winrate FROM uniqueGames WHERE game_mode = 'stormLeague' GROUP BY DATE(game_timestamp) ) AS subquery ORDER BY game_date;